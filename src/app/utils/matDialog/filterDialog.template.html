<div>
  <div class='titleOptions'>
    <div>
      <h1 mat-dialog-title>Group Filter</h1>
    </div>
    <div>
      <button mat-flat-button (click)="toggleView()">
        <span class="material-icons">
          settings
        </span>
      </button>
    </div>
  </div>

<div *ngIf="filterView">
<div class="criteriaForm">
<form [formGroup]="form">
  <div formArrayName='wellsCriteria' *ngFor="let wellCriteria of formData.controls; let i = index">
    <div [formGroupName]=i>
      <div *ngIf="formData.length > 1">
        <button mat-button (click)="removeCriteria(i)">
          <span class="material-icons">
            close
          </span>
        </button>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Choose Field</mat-label>
          <mat-select (selectionChange)="type(i)" formControlName="field" id="{{'field' + i}}">
            <mat-option *ngFor="let field of fields" [value]="field.value" >
              {{field.value}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Choose Condition</mat-label>
          <mat-select formControlName="condition" id="{{'criteria' + i}}">
            <mat-option *ngFor="let condition of conditions" [value]="condition.value" >
              {{condition.value}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div>
        <mat-form-field>
          <mat-label>Choose Value</mat-label>
          <mat-select formControlName="value" id="{{'value' + i}}">
            <mat-option *ngFor="let value of values" [value]="value" >
              {{value}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
      <div *ngIf="isConditionAdded(i)">
        <mat-form-field>
          <mat-label>Choose Operator</mat-label>
          <mat-select formControlName="operator" id="{{'operator' + i}}">
            <mat-option *ngFor="let operator of operators" [value]="operator" >
              {{operator}}
            </mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </div>
  </div>
  <div *ngIf="isLoggedIn">
    <mat-form-field>
      <mat-label>Choose Format</mat-label>
      <mat-select formControlName="reportType">
        <mat-option *ngFor="let format of formats" [value]="format.value" >
          {{format.value}}
        </mat-option>
      </mat-select>
    </mat-form-field>
  </div>
</form>
</div>
<div class="form-group">
  <div class="col-sm-offset-2 col-sm-4">
    <button  mat-button (click)="addCriteria()">Add Criteria</button>
  </div>
</div>
<div mat-dialog-actions>
  <button mat-button [mat-dialog-close]="form.value" (click)="onNoClick()">Reset</button>
  <button mat-button [mat-dialog-close]="form.value">Apply</button>
  <button mat-button title='Login to export data' [disabled]="!isLoggedIn" (click)="generateReport()">Export</button>
</div>
</div>
<div *ngIf="!filterView">
  <button mat-button (click)="saveFile()" title="Save Filter Choices" disabled='!formData.length'>Save Filter Choice</button>
</div>
<a style="display: none;" class="download-zip-link" #downloadZipLink></a>
</div>